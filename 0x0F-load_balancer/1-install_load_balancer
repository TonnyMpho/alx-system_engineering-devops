#!/usr/bin/env bash
# Install and configure HAproxy on your lb-01 server.

sudo apt-get update
sudo apt-get install -y haproxy

cat <<EOF |sudo tee /etc/haproxy/haproxy.conf
defaults
	log global
	mode http
	option httplog
	option dontlognull
	timeout connect 5000
	timeout client 50000
	timeout server 50000

backend we_servers
	server web-01 100.26.178.116:80
	server web-02 54.144.154.1:80
	balance roundrobin
EOF

sudo haproxy -c -f /etc/haproxy/haproxy.conf

service haproxy restart
